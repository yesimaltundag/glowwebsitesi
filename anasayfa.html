<!DOCTYPE html>
<html lang="tr" ng-app="GirisApp">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      http-equiv="Cache-Control"
      content="no-cache, no-store, must-revalidate"
    />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <title>Ana Sayfa - GLOW</title>

    <!-- Theme Flash Fix: Sayfa yüklenmeden önce tema uygula -->
    <script>
      (function() {
        // LocalStorage'tan tema oku ve hemen uygula
        var savedTheme = localStorage.getItem("selectedTheme") || "default";
        document.documentElement.className = 'loading-theme';
        
        if (savedTheme === 'dark') {
          document.documentElement.className += ' dark-theme';
        } else if (savedTheme === 'light') {
          document.documentElement.className += ' light-theme';
        } else {
          document.documentElement.className += ' default-theme';
        }
      })();
    </script>

    <!-- CSS -->
    <link rel="stylesheet" href="/assets/css/style.css" />

    <!-- AngularJS -->
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>
    <script src="/assets/js/app.js"></script>
    <link rel="stylesheet" href="assets/css/style.css" />
    
  </head>
  <body ng-controller="MainController">
    <!-- Header Component -->
    <ng-include src="'components/header.html'"></ng-include>

    <!-- Main Content -->
    <main class="main-content">
      <div class="homepage-container" ng-controller="AnasayfaController">
        <div>
          <!-- Logo Section -->

          <!-- Ana Slider Section -->
          <div class="ana-slider-container">
            <div
              class="ana-slider"
              ng-style="{'transform': 'translateX(-' + (currentAnaSlide * 100) + '%)'}"
            >
              <div
                class="ana-slide"
                ng-repeat="slide in anaSliderFotograflari"
                ng-click="slideClick(slide)"
              >
                <img ng-src="{{slide.url}}" alt="{{slide.baslik}}" />
                <div class="ana-slide-overlay">
                  <div class="ana-slide-title">{{slide.baslik}}</div>
                  <div class="ana-slide-desc">{{slide.aciklama}}</div>
                </div>
              </div>
            </div>

            <!-- Navigation Buttons -->
            <span class="ana-slider-nav prev" ng-click="prevAnaSlide()">◀</span>
            <span class="ana-slider-nav next" ng-click="nextAnaSlide()">▶</span>

            <!-- Dots -->
            <div class="ana-slider-dots">
              <div
                class="ana-slider-dot"
                ng-repeat="(index, slide) in anaSliderFotograflari"
                ng-class="{'active': index === currentAnaSlide}"
                ng-click="goToAnaSlide(index)"
              ></div>
            </div>
          </div>

          <div class="card-grid">
            <!-- Yazılar -->
            <div class="card">
              <img src="assets/images/yazilar.webp" alt="Yazılar" />
              <div class="card-content">
                <h3>Yazılar</h3>
                <p>En yeni yazılarımızı keşfedin ve ilham alın.</p>
                <button ng-click="gotoYazilar()">Oku Daha Fazla</button>
              </div>
            </div>

            <!-- Seyahat -->
            <div class="card">
              <img src="assets/images/seyahat.jpg" alt="Seyahat" />
              <div class="card-content">
                <h3>Seyahat</h3>
                <p>Gezdiğimiz yerlerden ilham alın ve yeni rotalar keşfedin.</p>
                <button ng-click="gotoSeyahat()">Oku Daha Fazla</button>
              </div>
            </div>

            <!-- Show -->
            <div class="card">
              <img src="assets/images/show.jpg" alt="Show" />
              <div class="card-content">
                <h3>Show</h3>
                <p>Gösteri ve etkinliklere dair içerikler burada.</p>
                <button ng-click="gotoShow()">Oku Daha Fazla</button>
              </div>
            </div>

            <!-- Sanat -->
            <div class="card">
              <img src="assets/images/sanat.jpg" alt="Sanat" />
              <div class="card-content">
                <h3>Sanat</h3>
                <p>Sanatın farklı dallarını keşfet ve ilham al!</p>
                <button ng-click="gotoSanat()">Oku Daha Fazla</button>
              </div>
            </div>

            <!-- Yemekler -->
            <div class="card">
              <img src="assets/images/yemekler.jpg" alt="Yemekler" />
              <div class="card-content">
                <h3>Yemekler</h3>
                <p>
                  Dünya mutfağından lezzetli tarifler ve yemek önerileri burada.
                </p>
                <button ng-click="gotoYemekler()">Oku Daha Fazla</button>
              </div>
            </div>

            <!-- Spor -->
            <div class="card">
              <img src="assets/images/spor.jpg" alt="Spor" />
              <div class="card-content">
                <h3>Spor</h3>
                <p>
                  Sağlıklı yaşam ve sporla ilgili motivasyon dolu içerikler.
                </p>
                <button ng-click="gotoSpor()">Oku Daha Fazla</button>
              </div>
            </div>
          </div>

          <!-- Kitaplar Carousel Section -->
          <h2 class="kitaplar-carousel-baslik">Kitaplar</h2>
          <div class="kitaplar-carousel-wrapper">
            <div
              class="kitaplar-carousel"
              ng-style="{'transform': 'translateX(-' + (currentKitapSlide * 280) + 'px)'}"
            >
              <div
                class="kitap-carousel-slide"
                ng-repeat="kitap in kitaplarCarousel"
                ng-click="kitapCarouselClick(kitap)"
              >
                <div class="kitap-carousel-card">
                  <img ng-src="{{kitap.foto}}" alt="{{kitap.ad}}" />
                  <div class="kitap-carousel-overlay">
                    <div class="kitap-carousel-title">{{kitap.ad}}</div>
                    <div class="kitap-carousel-author">{{kitap.yazar}}</div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Kitaplar Carousel Navigation -->
            <span class="kitap-carousel-nav prev" ng-click="prevKitapSlide()"
              >◀</span
            >
            <span class="kitap-carousel-nav next" ng-click="nextKitapSlide()"
              >▶</span
            >
          </div>

          <!-- Filmler Carousel Section -->
          <h2 class="filmler-carousel-baslik">Filmler</h2>
          <div class="filmler-carousel-wrapper">
            <!-- Loading durumu -->
            <div ng-if="filmlerCarousel.length === 0" class="filmler-loading">
              <div class="loading-spinner"></div>
              <p>Filmler yükleniyor...</p>
            </div>

            <!-- Filmler carousel -->
            <div
              class="filmler-carousel"
              ng-if="filmlerCarousel.length > 0"
              ng-style="{'transform': 'translateX(-' + (currentFilmSlide * 280) + 'px)'}"
            >
              <div
                class="film-carousel-slide"
                ng-repeat="film in filmlerCarousel"
                ng-click="filmCarouselClick(film)"
              >
                <div class="film-carousel-card">
                  <img ng-src="{{film.poster_url}}" alt="{{film.film_adi}}" />
                  <div class="film-carousel-overlay">
                    <div class="film-carousel-title">{{film.film_adi}}</div>
                    <div class="film-carousel-director">{{film.yonetmen}}</div>
                    <div class="film-carousel-rating">
                      ⭐ {{film.imdb_puani}}
                    </div>
                    <div class="film-carousel-year">{{film.yil}}</div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Filmler Carousel Navigation -->
            <span
              class="film-carousel-nav prev"
              ng-if="filmlerCarousel.length > 0"
              ng-click="prevFilmSlide()"
              >◀</span
            >
            <span
              class="film-carousel-nav next"
              ng-if="filmlerCarousel.length > 0"
              ng-click="nextFilmSlide()"
              >▶</span
            >
          </div>

          <!-- Diğer Carousel Section -->
          <h2 class="diger-carousel-baslik">Diğer</h2>
          <div class="diger-carousel-wrapper">
            <!-- Loading durumu -->
            <div ng-if="digerCarousel.length === 0" class="diger-loading">
              <div class="loading-spinner"></div>
              <p>İçerikler yükleniyor...</p>
            </div>

            <!-- Diğer carousel -->
            <div
              class="diger-carousel"
              ng-if="digerCarousel.length > 0"
              ng-style="{'transform': 'translateX(-' + (currentDigerSlide * 280) + 'px)'}"
            >
              <div
                class="diger-carousel-slide"
                ng-repeat="item in digerCarousel"
                ng-click="digerCarouselClick(item)"
              >
                <div class="diger-carousel-card">
                  <img
                    ng-src="{{item.foto || item.kapak_url || 'assets/images/logo.jpg'}}"
                    alt="{{item.ad || item.eser_adi || item.anime_adi}}"
                  />
                  <div class="diger-carousel-overlay">
                    <div class="diger-carousel-title">
                      {{item.ad || item.eser_adi || item.anime_adi}}
                    </div>
                    <div class="diger-carousel-subtitle">
                      {{item.yazar || item.yonetmen || item.yayin_evi}}
                    </div>
                    <div
                      class="diger-carousel-rating"
                      ng-if="item.puan || item.imdb_puani"
                    >
                      ⭐ {{item.puan || item.imdb_puani}}
                    </div>
                    <div class="diger-carousel-type">{{item.tip}}</div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Diğer Carousel Navigation -->
            <span
              class="diger-carousel-nav prev"
              ng-if="digerCarousel.length > 0"
              ng-click="prevDigerSlide()"
              >◀</span
            >
            <span
              class="diger-carousel-nav next"
              ng-if="digerCarousel.length > 0"
              ng-click="nextDigerSlide()"
              >▶</span
            >
          </div>
        </div>
      </div>
    </main>

    <!-- Footer Component -->
    <ng-include src="'components/footer.html'"></ng-include>

    <!-- Scroll to Top Button -->
    <button id="scrollTopBtn" title="Yukarı Çık" ng-click="scrollToTop()">
      ↑
    </button>
    <script>
      angular
        .module("GirisApp")
        .controller("MainController", function ($scope) {
          $scope.scrollToTop = function () {
            window.scrollTo({ top: 0, behavior: "smooth" });
          };
        })
        .controller("AnasayfaController", function ($scope, $http) {
          // Ana slider değişkenleri
          $scope.currentAnaSlide = 0;
          $scope.anaSliderFotograflari = [
            {
              url: "assets/images/yazilar1.jpg",
              baslik: "Yazılar",
              aciklama: "En yeni yazılarımızı keşfedin ve ilham alın",
              sayfa: "yazilar.html",
            },
            {
              url: "assets/images/show1.jpg",
              baslik: "Show",
              aciklama: "Gösteri ve etkinliklere dair içerikler burada",
              sayfa: "show.html",
            },
            {
              url: "assets/images/seyahat1.jpg",
              baslik: "Seyahat",
              aciklama:
                "Gezdiğimiz yerlerden ilham alın ve yeni rotalar keşfedin",
              sayfa: "seyahat.html",
            },
            {
              url: "assets/images/yemekler1.jpg",
              baslik: "Yemekler",
              aciklama:
                "Dünya mutfağından lezzetli tarifler ve yemek önerileri",
              sayfa: "yemekler.html",
            },
            {
              url: "assets/images/spor1.jpg",
              baslik: "Spor",
              aciklama:
                "Sağlıklı yaşam ve sporla ilgili motivasyon dolu içerikler",
              sayfa: "spor.html",
            },
            {
              url: "assets/images/sanat1.jpg",
              baslik: "Sanat",
              aciklama: "Sanatın farklı dallarını keşfet ve ilham al!",
              sayfa: "sanat-kategoriler.html",
            },
          ];

          // Ana slider fonksiyonları - Sonsuz döngü
          $scope.nextAnaSlide = function () {
            $scope.currentAnaSlide++;
            if ($scope.currentAnaSlide >= $scope.anaSliderFotograflari.length) {
              $scope.currentAnaSlide = 0; // Başa dön
            }
          };

          $scope.prevAnaSlide = function () {
            $scope.currentAnaSlide--;
            if ($scope.currentAnaSlide < 0) {
              $scope.currentAnaSlide = $scope.anaSliderFotograflari.length - 1; // Sona git
            }
          };

          $scope.goToAnaSlide = function (index) {
            $scope.currentAnaSlide = index;
          };

          // Slider fotoğrafına tıklama fonksiyonu
          $scope.slideClick = function (slide) {
            if (slide.sayfa) {
              window.location.href = slide.sayfa;
            }
          };

          // Otomatik slider - 5 saniyede bir değiş
          setInterval(function () {
            $scope.$apply(function () {
              $scope.nextAnaSlide();
            });
          }, 5000);

          // Sanat resimleri verisi
          $scope.sanatResimleri = [
            {
              baslik: "Mona Lisa",
              sanatci: "Leonardo da Vinci",
              tarih: "1503-1519",
              resim:
                "https://upload.wikimedia.org/wikipedia/commons/thumb/e/ec/Mona_Lisa%2C_by_Leonardo_da_Vinci%2C_from_C2RMF_retouched.jpg/687px-Mona_Lisa%2C_by_Leonardo_da_Vinci%2C_from_C2RMF_retouched.jpg",
              tarihce:
                "Mona Lisa, Leonardo da Vinci'nin en ünlü eseridir. İtalyan Rönesans döneminde yapılan bu portre, dünya sanat tarihinin en değerli ve en çok tanınan eserlerinden biridir. Eserin gizemli gülümsemesi ve sfumato tekniği ile yapılan yumuşak geçişler, sanat tarihinde devrim yaratmıştır. Şu anda Paris'teki Louvre Müzesi'nde sergilenmektedir.",
            },
            {
              baslik: "Yıldızlı Gece",
              sanatci: "Vincent van Gogh",
              tarih: "1889",
              resim:
                "https://upload.wikimedia.org/wikipedia/commons/thumb/e/ea/Van_Gogh_-_Starry_Night_-_Google_Art_Project.jpg/1280px-Van_Gogh_-_Starry_Night_-_Google_Art_Project.jpg",
              tarihce:
                "Yıldızlı Gece, Van Gogh'un en ünlü eserlerinden biridir. Sanatçının Saint-Rémy-de-Provence'daki akıl hastanesinde kaldığı dönemde yapılmıştır. Eser, gecenin dinamik ve hareketli bir yorumunu sunar. Dönen bulutlar ve parlayan yıldızlar, sanatçının iç dünyasının yoğun duygusal durumunu yansıtır. Modern sanatın en etkili eserlerinden biri olarak kabul edilir.",
            },
            {
              baslik: "Guernica",
              sanatci: "Pablo Picasso",
              tarih: "1937",
              resim:
                "https://upload.wikimedia.org/wikipedia/en/7/74/PicassoGuernica.jpg",
              tarihce:
                "Guernica, Picasso'nun İspanya İç Savaşı sırasında Nazi Almanyası'nın Guernica şehrini bombalaması üzerine yaptığı güçlü bir anti-savaş eseridir. Siyah, beyaz ve gri tonlarında yapılan eser, savaşın dehşetini ve acısını dramatik bir şekilde yansıtır. Modern sanatın en önemli politik eserlerinden biri olarak kabul edilir ve barışın sembolü haline gelmiştir.",
            },
            {
              baslik: "Çığlık",
              sanatci: "Edvard Munch",
              tarih: "1893",
              resim:
                "https://upload.wikimedia.org/wikipedia/commons/thumb/c/c5/Edvard_Munch%2C_1893%2C_The_Scream%2C_oil%2C_tempera_and_pastel_on_cardboard%2C_91_x_73_cm%2C_National_Gallery_of_Norway.jpg/1280px-Edvard_Munch%2C_1893%2C_The_Scream%2C_oil%2C_tempera_and_pastel_on_cardboard%2C_91_x_73_cm%2C_National_Gallery_of_Norway.jpg",
              tarihce:
                "Çığlık, Edvard Munch'un en ünlü eseridir ve ekspresyonist sanatın simgesi haline gelmiştir. Eser, modern insanın varoluşsal kaygısını ve yalnızlığını güçlü bir şekilde ifade eder. Dalgalı çizgiler ve yoğun renkler kullanılarak yapılan eser, sanatçının iç dünyasındaki huzursuzluğu ve toplumsal değişimlerin yarattığı stresi yansıtır.",
            },
            {
              baslik: "Son Akşam Yemeği",
              sanatci: "Leonardo da Vinci",
              tarih: "1495-1498",
              resim:
                "https://upload.wikimedia.org/wikipedia/commons/thumb/4/4b/%C3%9Altima_Cena_-_Da_Vinci_5.jpg/1280px-%C3%9Altima_Cena_-_Da_Vinci_5.jpg",
              tarihce:
                "Son Akşam Yemeği, Leonardo da Vinci'nin Milano'daki Santa Maria delle Grazie manastırının yemek salonunda yaptığı fresk eseridir. İsa'nın havarileriyle son akşam yemeğini yediği anı tasvir eder. Perspektif kullanımı ve karakterlerin duygusal ifadeleri ile Rönesans sanatının en önemli eserlerinden biri olarak kabul edilir.",
            },
            {
              baslik: "Venüs'ün Doğuşu",
              sanatci: "Sandro Botticelli",
              tarih: "1485",
              resim:
                "https://upload.wikimedia.org/wikipedia/commons/thumb/0/0b/Sandro_Botticelli_-_La_nascita_di_Venere_-_Google_Art_Project.jpg/1280px-Sandro_Botticelli_-_La_nascita_di_Venere_-_Google_Art_Project.jpg",
              tarihce:
                "Venüs'ün Doğuşu, Botticelli'nin en ünlü eserlerinden biridir. Antik Yunan mitolojisinden esinlenen eser, güzellik tanrıçası Venüs'ün deniz köpüğünden doğuşunu tasvir eder. Rönesans döneminin en güzel eserlerinden biri olarak kabul edilir ve klasik mitolojinin yeniden canlandırılmasının simgesi haline gelmiştir.",
            },
          ];

          // Modal durumları
          $scope.sanatGaleriModalGoster = false;
          $scope.sanatModalGoster = false;
          $scope.seciliSanat = null;

          // Sanat galerisi açma fonksiyonu
          $scope.sanatGaleriAc = function () {
            $scope.sanatGaleriModalGoster = true;
            document.body.style.overflow = "hidden"; // Scroll'u engelle
          };

          // Sanat galerisi kapatma fonksiyonu
          $scope.sanatGaleriModalKapat = function () {
            $scope.sanatGaleriModalGoster = false;
            document.body.style.overflow = "auto"; // Scroll'u geri aç
          };

          // Sanat tarihçesi gösterme fonksiyonu
          $scope.sanatTarihcesiGoster = function (sanat) {
            $scope.seciliSanat = sanat;
            $scope.sanatModalGoster = true;
            $scope.sanatGaleriModalGoster = false; // Galeri modal'ını kapat
          };

          // Sanat tarihçesi modal kapatma fonksiyonu
          $scope.sanatModalKapat = function () {
            $scope.sanatModalGoster = false;
            $scope.seciliSanat = null;
            $scope.sanatGaleriModalGoster = true; // Galeri modal'ını geri aç
          };

          // Sayfa yönlendirme fonksiyonları
          $scope.gotoYazilar = function () {
            window.location.href = "yazilar.html";
          };

          $scope.gotoSeyahat = function () {
            window.location.href = "seyahat.html";
          };

          $scope.gotoShow = function () {
            window.location.href = "show.html";
          };

          $scope.gotoSanat = function () {
            window.location.href = "sanat-kategoriler.html";
          };

          $scope.gotoYemekler = function () {
            window.location.href = "yemekler.html";
          };

          $scope.gotoSpor = function () {
            window.location.href = "spor.html";
          };

          // Kitaplar Carousel değişkenleri
          $scope.currentKitapSlide = 0;
          $scope.kitaplarCarousel = [];

          // Kitapları veritabanından yükle (her yenilemede rastgele 8 kitap)
          var timestamp = Date.now();
          console.log("API çağrısı yapılıyor, timestamp:", timestamp);
          $http
            .get("kitaplar_api.php?t=" + timestamp + "&r=" + Math.random())
            .then(function (response) {
              console.log("API Response:", response.data);
              if (response.data.success) {
                // Veritabanından gelen verileri carousel formatına dönüştür
                $scope.kitaplarCarousel = response.data.kitaplar.map(function (
                  kitap
                ) {
                  return {
                    ad: kitap.kitap_adi,
                    yazar: kitap.yazar,
                    foto: kitap.kapak_url,
                    rating: Math.floor(Math.random() * 3) + 3, // Rastgele rating (3-5)
                    favorites: Math.floor(Math.random() * 1000) + 50, // Rastgele favori sayısı
                    publisher: "GLOW Yayınları", // Varsayılan yayınevi
                  };
                });
                console.log(
                  "Rastgele 8 kitap yüklendi:",
                  $scope.kitaplarCarousel.length
                );
              } else {
                console.error(
                  "Kitaplar yüklenirken hata:",
                  response.data.error
                );
              }
            })
            .catch(function (error) {
              console.error("Kitaplar yüklenirken hata:", error);
            });

          // Kitaplar carousel fonksiyonları
          $scope.nextKitapSlide = function () {
            var maxSlide = Math.max(0, $scope.kitaplarCarousel.length - 4);

            // Eğer son slide'daysak, baştan başla
            if ($scope.currentKitapSlide >= maxSlide) {
              $scope.currentKitapSlide = 0;
            } else {
              $scope.currentKitapSlide = Math.min(
                $scope.currentKitapSlide + 1,
                maxSlide
              );
            }
          };

          $scope.prevKitapSlide = function () {
            // Eğer ilk slide'daysak, sona git
            if ($scope.currentKitapSlide <= 0) {
              var maxSlide = Math.max(0, $scope.kitaplarCarousel.length - 4);
              $scope.currentKitapSlide = maxSlide;
            } else {
              $scope.currentKitapSlide = Math.max(
                $scope.currentKitapSlide - 1,
                0
              );
            }
          };

          // Kitap carousel'a tıklama fonksiyonu
          $scope.kitapCarouselClick = function (kitap) {
            // Temiz URL için kitap adını URL-friendly hale getir
            var urlFriendlyKitap = kitap.ad
              .toLowerCase()
              .replace(/[^a-zA-Z0-9çğıöşüÇĞIİÖŞÜ]/g, "-")
              .replace(/-+/g, "-")
              .replace(/^-|-$/g, "");
            // URL encode et
            var encodedKitap = encodeURIComponent(urlFriendlyKitap);
            window.location.href = "kitap/" + encodedKitap;
          };

          // Kitaplar carousel otomatik kaydırma - 3 saniyede bir
          setInterval(function () {
            $scope.$apply(function () {
              $scope.nextKitapSlide();
            });
          }, 3000);

          // Filmler Carousel değişkenleri
          $scope.currentFilmSlide = 0;
          $scope.filmlerCarousel = [];

          // Filmleri veritabanından yükle (her yenilemede rastgele 8 film)
          var filmTimestamp = Date.now();
          console.log(
            "Filmler API çağrısı yapılıyor, timestamp:",
            filmTimestamp
          );
          $http
            .get("filmler_api.php?t=" + filmTimestamp + "&r=" + Math.random())
            .then(function (response) {
              console.log("Filmler API Response:", response.data);
              if (response.data.success) {
                // Veritabanından gelen verileri carousel formatına dönüştür
                $scope.filmlerCarousel = response.data.filmler.map(function (
                  film
                ) {
                  return {
                    id: film.id,
                    film_adi: film.film_adi,
                    yonetmen: film.yonetmen,
                    poster_url: film.poster_url,
                    imdb_puani: film.imdb_puani,
                    yil: film.yil,
                    kategori: film.kategori,
                    tanitim: film.tanitim,
                  };
                });
                console.log(
                  "✅ Rastgele 8 film yüklendi:",
                  $scope.filmlerCarousel.length
                );
                console.log("📽️ Filmler:", $scope.filmlerCarousel);
              } else {
                console.error(
                  "❌ Filmler yüklenirken hata:",
                  response.data.error
                );
                // Hata durumunda boş array oluştur
                $scope.filmlerCarousel = [];
              }
            })
            .catch(function (error) {
              console.error("❌ Filmler yüklenirken hata:", error);
              // Hata durumunda boş array oluştur
              $scope.filmlerCarousel = [];
            });

          // Filmler carousel fonksiyonları
          $scope.nextFilmSlide = function () {
            var maxSlide = Math.max(0, $scope.filmlerCarousel.length - 4);

            // Eğer son slide'daysak, baştan başla
            if ($scope.currentFilmSlide >= maxSlide) {
              $scope.currentFilmSlide = 0;
            } else {
              $scope.currentFilmSlide = Math.min(
                $scope.currentFilmSlide + 1,
                maxSlide
              );
            }
          };

          $scope.prevFilmSlide = function () {
            // Eğer ilk slide'daysak, sona git
            if ($scope.currentFilmSlide <= 0) {
              var maxSlide = Math.max(0, $scope.filmlerCarousel.length - 4);
              $scope.currentFilmSlide = maxSlide;
            } else {
              $scope.currentFilmSlide = Math.max(
                $scope.currentFilmSlide - 1,
                0
              );
            }
          };

          // Film carousel'a tıklama fonksiyonu
          $scope.filmCarouselClick = function (film) {
            window.location.href =
              "film-detay.html?id=" +
              film.id +
              "&film=" +
              encodeURIComponent(film.film_adi);
          };

          // Filmler carousel otomatik kaydırma - 3 saniyede bir
          setInterval(function () {
            $scope.$apply(function () {
              $scope.nextFilmSlide();
            });
          }, 3000);

          // Diğer Carousel değişkenleri
          $scope.currentDigerSlide = 0;
          $scope.digerCarousel = [];

          // Diğer içerikleri veritabanından yükle (tiyatro, anime, belgesel)
          console.log("🎯 Diğer içerikler yükleniyor...");

          // Tiyatro eserlerini getir
          $http
            .get("api.php?tiyatro=1&limit=3")
            .then(function (tiyatroResponse) {
              console.log("🎭 Tiyatro response:", tiyatroResponse.data);
              var tiyatroItems = [];
              if (tiyatroResponse.data && Array.isArray(tiyatroResponse.data)) {
                tiyatroItems = tiyatroResponse.data.map(function (eser) {
                  return {
                    id: eser.id,
                    ad: eser.eser_adi,
                    yazar: eser.yazar,
                    foto: eser.kapak_url || "assets/images/logo.jpg",
                    puan: eser.puan,
                    tip: "Tiyatro",
                    sayfa: "tiyatro-detay.html",
                  };
                });
              }

              // Animeleri getir
              $http
                .get("api.php?anime=1&limit=3")
                .then(function (animeResponse) {
                  console.log("🎬 Anime response:", animeResponse.data);
                  var animeItems = [];
                  if (animeResponse.data && Array.isArray(animeResponse.data)) {
                    animeItems = animeResponse.data.map(function (anime) {
                      return {
                        id: anime.id,
                        ad: anime.anime_adi,
                        yazar: anime.yonetmen,
                        foto: anime.kapak_url || "assets/images/logo.jpg",
                        puan: anime.puan,
                        tip: "Anime",
                        sayfa: "anime-detay.html",
                      };
                    });
                  }

                  // Belgeselleri getir
                  $http
                    .get("api.php?belgesel=1&limit=4")
                    .then(function (belgeselResponse) {
                      console.log(
                        "📺 Belgesel response:",
                        belgeselResponse.data
                      );
                      var belgeselItems = [];
                      if (
                        belgeselResponse.data &&
                        Array.isArray(belgeselResponse.data)
                      ) {
                        belgeselItems = belgeselResponse.data.map(function (
                          belgesel
                        ) {
                          return {
                            id: belgesel.id,
                            ad: belgesel.belgesel_adi,
                            yazar: belgesel.yonetmen,
                            foto:
                              belgesel.kapak_url || "assets/images/logo.jpg",
                            puan: belgesel.puan,
                            tip: "Belgesel",
                            sayfa: "belgesel-detay.html",
                          };
                        });
                      }

                      // Tüm içerikleri birleştir ve karıştır
                      $scope.digerCarousel = tiyatroItems
                        .concat(animeItems)
                        .concat(belgeselItems);

                      // Array'i karıştır
                      for (
                        var i = $scope.digerCarousel.length - 1;
                        i > 0;
                        i--
                      ) {
                        var j = Math.floor(Math.random() * (i + 1));
                        var temp = $scope.digerCarousel[i];
                        $scope.digerCarousel[i] = $scope.digerCarousel[j];
                        $scope.digerCarousel[j] = temp;
                      }

                      console.log(
                        "✅ Diğer içerikler yüklendi:",
                        $scope.digerCarousel.length
                      );
                      console.log("🎭 Tiyatro:", tiyatroItems.length);
                      console.log("🎬 Anime:", animeItems.length);
                      console.log("📺 Belgesel:", belgeselItems.length);
                    })
                    .catch(function (error) {
                      console.error("❌ Belgeseller yüklenirken hata:", error);
                      // Hata durumunda boş array ile devam et
                      $scope.digerCarousel = tiyatroItems.concat(animeItems);
                    });
                })
                .catch(function (error) {
                  console.error("❌ Animeler yüklenirken hata:", error);
                  // Hata durumunda sadece tiyatro ile devam et
                  $scope.digerCarousel = tiyatroItems;
                });
            })
            .catch(function (error) {
              console.error("❌ Tiyatro eserleri yüklenirken hata:", error);
              // Tüm API'ler başarısız olursa boş array
              $scope.digerCarousel = [];
            });

          // Diğer carousel fonksiyonları
          $scope.nextDigerSlide = function () {
            var maxSlide = Math.max(0, $scope.digerCarousel.length - 4);

            // Eğer son slide'daysak, baştan başla
            if ($scope.currentDigerSlide >= maxSlide) {
              $scope.currentDigerSlide = 0;
            } else {
              $scope.currentDigerSlide = Math.min(
                $scope.currentDigerSlide + 1,
                maxSlide
              );
            }
          };

          $scope.prevDigerSlide = function () {
            // Eğer ilk slide'daysak, sona git
            if ($scope.currentDigerSlide <= 0) {
              var maxSlide = Math.max(0, $scope.digerCarousel.length - 4);
              $scope.currentDigerSlide = maxSlide;
            } else {
              $scope.currentDigerSlide = Math.max(
                $scope.currentDigerSlide - 1,
                0
              );
            }
          };

          // Diğer carousel'a tıklama fonksiyonu
          $scope.digerCarouselClick = function (item) {
            window.location.href = item.sayfa + "?id=" + item.id;
          };

          // Diğer carousel otomatik kaydırma - 4 saniyede bir
          setInterval(function () {
            $scope.$apply(function () {
              $scope.nextDigerSlide();
            });
          }, 4000);
        });
    </script>
  </body>
</html>
